{% extends "base.html" %}

{% block content %}
<div class="home-container">
    <section class="hero">
        <div class="hero-content">
            <div class="hero-text">
                <div class="greeting">ðŸ‘‹ Hello</div>
                {% for paragraph in config.extra.intro_paragraphs %}
                <p class="intro-paragraph" data-text="{{ paragraph }}"></p>
                {% endfor %}

                <div class="contact-info">
                    {% for contact in config.extra.contact %}
                    <span class="contact-item">
                        <img src="{{ get_url(path=contact.icon) }}" alt="{{ contact.text }}" class="contact-icon">
                        <a href="{{ contact.url }}" {% if contact.new_tab or (not contact.url |
                            starts_with(string="mailto:" )) %}target="_blank" rel="noopener noreferrer" {% endif %}>{{
                            contact.text }}</a>
                    </span>
                    {% endfor %}
                </div>
            </div>
            <div class="hero-image">
                <img src="{{ get_url(path='images/profile.jpg') }}" alt="{{ config.extra.author }}"
                    class="profile-photo">
            </div>
        </div>
    </section>

    {% if config.extra.show_skills %}
    <section class="tech-stack">
        <div class="tech-categories">
            <div class="tech-group">
                <span class="tech-label">Languages:</span>
                {% for lang in config.extra.languages %}
                <span class="tech-item">{{ lang }}</span>{% if not loop.last %}, {% endif %}
                {% endfor %}
            </div>

            <div class="tech-group">
                <span class="tech-label">Tools & Platforms:</span>
                {% for tech in config.extra.technologies %}
                <span class="tech-item">{{ tech }}</span>{% if not loop.last %}, {% endif %}
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}

    {% if config.extra.show_experience %}
    <section class="experience-section">
        <h3>Work Experience</h3>
        <div class="experience-list">
            {% for company in config.extra.companies %}
            <div class="company-block">
                <h4 class="company-title">
                    <a href="{{ company.url }}" target="_blank" rel="noopener noreferrer">{{ company.name }}</a>
                </h4>

                {% for position in company.positions %}
                <div class="position">
                    <div class="position-header">
                        <span class="role">{{ position.title }}</span>
                        <span class="period">{{ position.duration }}</span>
                    </div>
                    {% if position.points %}
                    <ul class="position-points">
                        {% for point in position.points %}
                        <li>{{ point }}</li>
                        {% endfor %}
                    </ul>
                    {% elif position.description %}
                    <p class="position-description">{{ position.description }}</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if config.extra.show_projects %}
    <section class="projects-section">
        <h3>Projects</h3>
        <div class="projects-grid">
            {% for project in config.extra.projects %}
            <div class="project-card">
                <div class="project-title">
                    <a href="{{ project.url }}" target="_blank" rel="noopener noreferrer">{{ project.name }}</a>
                </div>
                <p class="project-description">{{ project.description }}</p>
                <div class="project-tech">
                    {% for tag in project.tags %}
                    <span class="tech-tag">#{{ tag }}</span>
                    {% endfor %}
                </div>
                <div class="project-links">
                    <a href="{{ project.url }}" target="_blank" rel="noopener noreferrer">View Code â†’</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if config.extra.show_education %}
    <section class="education-section">
        <h3>Education</h3>
        <div class="education-list">
            {% for edu in config.extra.education %}
            <div class="education-item">
                <div class="education-header">
                    <div class="education-main">
                        <h4 class="institution">{{ edu.institution }}</h4>
                        <p class="degree">{{ edu.degree }}{% if edu.field %} in {{ edu.field }}{% endif %}</p>
                    </div>
                    <div class="education-meta">
                        <span class="duration">{{ edu.year }}</span>
                        {% if edu.gpa %}
                        <span class="gpa">{{ edu.gpa }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>

<script>
    // Parse markdown-style links [url]{text} in intro paragraphs
    document.addEventListener('DOMContentLoaded', function () {
        const paragraphs = document.querySelectorAll('.intro-paragraph[data-text]');

        paragraphs.forEach(function (paragraph) {
            const text = paragraph.getAttribute('data-text');

            // Regular expression to match [url]{text} pattern
            const linkRegex = /\[([^\]]+)\]\{([^}]+)\}/g;
            let html = text;
            let match;

            // Replace all [url]{text} patterns with actual links
            while ((match = linkRegex.exec(text)) !== null) {
                const linkUrl = match[1];
                const linkText = match[2];
                const linkHtml = `<a href="${linkUrl}" target="_blank" rel="noopener noreferrer">${linkText}</a>`;
                html = html.replace(match[0], linkHtml);
            }

            paragraph.innerHTML = html;
            paragraph.removeAttribute('data-text');
        });
    });
</script>

{% endblock content %}